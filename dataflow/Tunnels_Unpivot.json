{
	"name": "Tunnels_Unpivot",
	"properties": {
		"folder": {
			"name": "Tunnels"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Tunnels",
						"type": "DatasetReference"
					},
					"name": "Tunnel"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "SQL_UnpivotTunnel",
						"type": "DatasetReference"
					},
					"name": "sinkUppivot"
				}
			],
			"transformations": [
				{
					"name": "UnPivotTunnel"
				},
				{
					"name": "Select1"
				},
				{
					"name": "dateandtunnel"
				}
			],
			"script": "source(output(\n\t\tKey as string,\n\t\tDatetime as string,\n\t\tDate as string,\n\t\tTunnel as string,\n\t\tPc1 as string,\n\t\tPc2 as string,\n\t\tPc3 as string,\n\t\tPc4 as string,\n\t\tPc5 as string,\n\t\tPc6 as string,\n\t\tPc7 as string,\n\t\tPc8 as string,\n\t\tPc9 as string,\n\t\tPc10 as string,\n\t\tPc11 as string,\n\t\tPc12 as string,\n\t\tMin as string,\n\t\tMax as string,\n\t\tAverage as string,\n\t\tSensorOn as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> Tunnel\nSelect1 unpivot(output(\n\t\tSensor as string,\n\t\tPc1 as string,\n\t\tPc2 as string,\n\t\tPc3 as string,\n\t\tPc4 as string,\n\t\tPc5 as string,\n\t\tPc6 as string,\n\t\tPc7 as string,\n\t\tPc8 as string,\n\t\tPc9 as string,\n\t\tPc10 as string,\n\t\tPc11 as string,\n\t\tPc12 as string\n\t),\n\tungroupBy(Datetime),\n\tlateral: true,\n\tignoreNullPivots: true) ~> UnPivotTunnel\nTunnel select(mapColumn(\n\t\tPc1,\n\t\tPc2,\n\t\tPc3,\n\t\tPc4,\n\t\tPc5,\n\t\tPc6,\n\t\tPc7,\n\t\tPc8,\n\t\tPc9,\n\t\tPc10,\n\t\tPc11,\n\t\tPc12,\n\t\tDatetime\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select1\nUnPivotTunnel derive(Date = split(Datetime, ' ')[1],\n\t\tTunnel = 'E18 TorsbuÃ¥stunnelen') ~> dateandtunnel\ndateandtunnel sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tDatetime as string,\n\t\tDate as string,\n\t\tTunnel as string,\n\t\tSignal as string,\n\t\tValue as string\n\t),\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tpreSQLs:['Truncate table dbo.Tunnels_Unpivot'],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError',\n\tmapColumn(\n\t\tDatetime,\n\t\tSignal = Sensor,\n\t\tValue = Pc1,\n\t\tDate,\n\t\tTunnel\n\t)) ~> sinkUppivot"
		}
	}
}